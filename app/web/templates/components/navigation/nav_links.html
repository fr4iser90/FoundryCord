{# app/web/templates/components/navigation/nav_links.html #}
{% set selected_guild = request.session.get('selected_guild') %}
<ul class="nav-links">
    <li class="nav-item">
        <a class="nav-link {% if request.url.path == '/home' %}active{% endif %}" href="/home">
            <i class="bi bi-house"></i>
            <span>Home</span>
        </a>
    </li>
    
    {# --- Guild-Specific Links (Require a selected guild) --- #}
    {% if selected_guild and selected_guild.guild_id %}
        {% set guild_base_path = "/guild/" + selected_guild.guild_id %}
        
        <li class="nav-item">
            {# Link to Guild Users page for the selected guild #}
            <a class="nav-link {% if request.url.path.startswith(guild_base_path + '/admin/users') %}active{% endif %}" 
               href="{{ guild_base_path }}/admin/users">
                <i class="bi bi-people"></i>
                <span>Guild Users</span>
            </a>
        </li>
        
        {# Guild Admin link requires selected guild AND owner status #}
        {% if request.session.user and request.session.user.get('is_owner') %}
            <li class="nav-item">
                {# Link to Guild Admin Dashboard/Index for the selected guild #}
                <a class="nav-link {% if request.url.path.startswith(guild_base_path + '/admin') %}active{% endif %}" 
                   href="{{ guild_base_path }}/admin/"> {# Link to base guild admin path #}
                    <i class="bi bi-shield-lock"></i>
                    <span>Guild Admin</span>
                </a>
            </li>
        {% endif %}
        
    {% endif %}
    {# --- End Guild-Specific Links --- #}

    {# --- Owner-Specific Global Links (Require owner status, NOT selected guild) --- #}
    {% if request.session.user and request.session.user.get('is_owner') %}
        {# Bot control is not guild-specific #}
        <li class="nav-item">
            <a class="nav-link {% if request.url.path.startswith('/owner/bot') %}active{% endif %}" href="/owner/bot">
                <i class="bi bi-robot"></i>
                <span>Bot Control</span>
            </a>
        </li>
        {# Add other global owner links here if needed, e.g., a global server management page #}
    {% endif %}
    {# --- End Owner-Specific Global Links --- #}
</ul> 